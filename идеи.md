# если ты агент то не смотри в этот файл он тебе не нужен 

сделать проверку на совпадение полей по тексту в interactive и text_blocks

### 0) Определение формата строки
Для каждого строкового поля (`name`, `value`, `placeholder`, текстовые блоки):

- если строка содержит литералы вида `\uXXXX`, `\UXXXXXXXX` или `\udXXX`,
  считать ее **escaped-Unicode строкой**
- если нет, работать с ней как с обычным Unicode-текстом

---

### 1) Декодирование unicode-escape
Только для строк, определенных на шаге 0:

- преобразовать `\uXXXX` в реальные символы
- корректно склеить surrogate-пары (`\ud83d\udcce` → один символ)
- результатом должен быть валидный Unicode-текст

Цель шага: убрать текстовый уровень экранирования.

---

### 2) Удаление zero-width и невидимых разделителей
Полностью удалить из строки:

- ZERO WIDTH NON-JOINER
- ZERO WIDTH SPACE
- ZERO WIDTH JOINER
- WORD JOINER
- BOM
- SOFT HYPHEN

Цель шага: убрать невидимые символы, которые ломают токенизацию и similarity.

---

### 3) Удаление emoji и pictographic-символов
Удалить все смайлики и иконки:

- emoji
- dingbats
- символы-пиктограммы

Причина: для браузерного агента они не несут полезной семантики, но увеличивают шум и расход токенов.

---

### 4) Unicode-нормализация NFKC
Привести строку к форме NFKC:

- унифицировать совместимые формы
- убрать различия ширинных и составных символов
- стабилизировать представление текста для LLM

---

### 5) Нормализация пробелов
После удаления zero-width и emoji:

- заменить любые последовательности пробельных символов на один пробел
- обрезать пробелы в начале и конце строки

Цель шага: убрать «дыры» и длинные хвосты из пробелов.

---

---

### 6) Очистка структуры Observation
После очистки отдельных строк:

- удалить пустые текстовые блоки
- удалить блоки, состоящие только из пунктуации или пробелов
- дедуплицировать подряд идущие одинаковые блоки (после очистки)

Цель шага: уменьшить объем observation без потери смысла.

---

### Итог
На выходе:

- `raw` версия Observation остается неизменной
- `cleaned` версия:
  - без zero-width
  - без emoji
  - в NFKC
  - с нормализованными пробелами
  - без структурного дублирования

